{"version":3,"sources":["../../src/pagy.ts"],"names":[],"mappings":"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","file":"pagy.js","sourcesContent":["// This file is the source that generates pagy.js, polyfilled with the `@babel/preset-env` `\"useBuiltIns\": \"entry\"`.\n// You can generate a custom targeted javascript file for the browsers you need by changing that settings in package.json,\n// then compile it with `npm run compile -w src`.\n\n// Args types and interfaces from data-pagy-json\ntype PagyJSON          = readonly [\"nav\", ...NavArgs] | [\"combo_nav\", ...ComboNavArgs] | [\"items_selector\", ...ItemsSelectorArgs]\ntype NavArgs           = readonly [NavTags, NavSequels, null|NavLabelSequels, string?]\ntype ComboNavArgs      = readonly [string, string?]\ntype ItemsSelectorArgs = readonly [number, string, string?]\n\ninterface NavTags {\n    readonly before: string\n    readonly link:   string\n    readonly active: string\n    readonly gap:    string\n    readonly after:  string\n}\ninterface NavSequels      { readonly [width:string]: (string|number|\"gap\")[] }\ninterface NavLabelSequels { readonly [width:string]: string[] }\ninterface Element         { pagyRender(): void }\n\n// The Pagy object\nconst Pagy = {\n    version: \"5.7.0\",\n\n    // Scan for \"data-pagy-json\" elements, parse their JSON content and call their init functions\n    init(arg?:Element|never) {\n        const target   = arg instanceof Element ? arg : document;\n        const elements = target.querySelectorAll(\"[data-pagy-json]\");\n        const warn     = (el:Element, err:unknown) => console.warn(\"Pagy.init() skipped element: %o\\n%s\", el, err);\n        for (const element of elements) {\n            const json = element.getAttribute(\"data-pagy-json\") as string;\n            try {\n                const [keyword, ...args] = JSON.parse(json) as PagyJSON;\n                if (keyword === \"nav\") {\n                    Pagy.initNav(element, args as NavArgs);\n                } else if (keyword === \"combo_nav\") {\n                    Pagy.initComboNav(element, args as ComboNavArgs);\n                } else if (keyword === \"items_selector\") {\n                    Pagy.initItemsSelector(element, args as ItemsSelectorArgs);\n                } else {\n                    warn(element, `Illegal PagyJSON keyword: expected \"nav\"|\"combo_nav\"|\"items_selector\" got \"${keyword}\"`);\n                }\n            } catch (err) { warn(element, err) }\n        }\n    },\n\n    // Init the *_nav_js helpers\n    initNav(el:Element, [tags, sequels, labelSequels, trimParam]:NavArgs) {\n        const container = el.parentElement ?? el;\n        const widths    = Object.getOwnPropertyNames(sequels).map(w => parseInt(w)).sort((a, b) => b - a);\n        let lastWidth   = -1;\n        const fillIn    = (link:string, page:string, label:string):string =>\n                              link.replace(/__pagy_page__/g, page).replace(/__pagy_label__/g, label);\n        (el.pagyRender = function() {\n            const width = widths.find(w => w < container.clientWidth) || 0;\n            if (width === lastWidth) { return } // no change: abort\n            let html     = tags.before;\n            const series = sequels[width.toString()];\n            const labels = labelSequels?.[width.toString()] ?? series.map(l => l.toString());\n            for (const i in series) {\n                const item  = series[i];\n                const label = labels[i];\n                if (typeof trimParam === \"string\" && item === 1) {\n                    html += Pagy.trim(fillIn(tags.link, item.toString(), label), trimParam);\n                } else if (typeof item === \"number\") {\n                    html += fillIn(tags.link, item.toString(), label);\n                } else if (item === \"gap\") {\n                    html += tags.gap;\n                } else { // active page\n                    html += fillIn(tags.active, item, label);\n                }\n            }\n            html += tags.after;   // eslint-disable-line align-assignments/align-assignments\n            el.innerHTML = \"\";\n            el.insertAdjacentHTML(\"afterbegin\", html);\n            lastWidth = width;\n        })();\n        if (el.classList.contains(\"pagy-rjs\")) { Pagy.rjsObserver.observe(container) }\n    },\n\n    // The observer instance for responsive navs\n    rjsObserver: new ResizeObserver(entries => {\n        entries.filter(e => e.contentBoxSize)\n               .forEach(e => e.target.querySelectorAll(\".pagy-rjs\")\n                                     .forEach(rjs => rjs.pagyRender()));\n    }),\n\n    // Init the *_combo_nav_js helpers\n    initComboNav(el:Element, [link, trimParam]:ComboNavArgs) {\n        Pagy.initInput(el, inputValue => [inputValue, link.replace(/__pagy_page__/, inputValue)], trimParam);\n    },\n\n    // Init the items_selector_js helper\n    initItemsSelector(el:Element, [from, link, trimParam]:ItemsSelectorArgs) {\n        Pagy.initInput(el, inputValue => {\n            const page = Math.max(Math.ceil(from / parseInt(inputValue)), 1).toString();\n            const html = link.replace(/__pagy_page__/, page).replace(/__pagy_items__/, inputValue);\n            return [page, html];\n        }, trimParam);\n    },\n\n    // Init the input element\n    initInput(el:Element, getVars:(v:string)=>[string, string], trimParam?:string) {\n        const input   = el.querySelector(\"input\") as HTMLInputElement;\n        const initial = input.value;\n        const action  = function() {\n            if (input.value === initial) { return }  // not changed\n            const [min, val, max] = [input.min, input.value, input.max].map(n => parseInt(n) || 0);\n            if (val < min || val > max) {  // reset invalid/out-of-range\n                input.value = initial;\n                input.select();\n                return;\n            }\n            let [page, html] = getVars(input.value);   // eslint-disable-line prefer-const\n            if (typeof trimParam === \"string\" && page === \"1\") { html = Pagy.trim(html, trimParam) }\n            el.insertAdjacentHTML(\"afterbegin\", html);\n            (el.querySelector(\"a\") as HTMLAnchorElement).click();\n        };\n        [\"change\", \"focus\"].forEach(e => input.addEventListener(e, input.select));        // auto-select\n        input.addEventListener(\"focusout\", action);                                       // trigger action\n        input.addEventListener(\"keypress\", e => { if (e.key === \"Enter\") { action() } }); // trigger action\n    },\n\n    // Trim the ${page-param}=1 params in links\n    trim: (link:string, param:string) => link.replace(new RegExp(`[?&]${param}=1\\\\b(?!&)|\\\\b${param}=1&`), \"\")\n};\n"]}