{"version":3,"sources":["../../src/pagy.ts"],"names":[],"mappings":"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","file":"pagy.js","sourcesContent":["// This file is the source that generates pagy.js, polyfilled with the `@babel/preset-env` `\"useBuiltIns\": \"entry\"`.\n// You can generate a custom targeted javascript file for the browsers you need by changing that settings in package.json,\n// then compile it with `npm run compile -w src`.\n\n// Add pagyRender to Element\ninterface Element {\n    pagyRender():void;\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavTags {\n    readonly before:string;\n    readonly link:string;\n    readonly active:string;\n    readonly gap:string;\n    readonly after:string;\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavSequels {\n    readonly [width:string]:(string|number|\"gap\")[];\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavLabelSequels {\n    [width:string]:(string|\"gap\")[];\n}\n\n// The Pagy object\nconst Pagy = {\n    version: \"5.6.9\",\n\n    // Scan for \"data-pagy-json\" elements, parse their JSON content and apply their functions\n    init(arg?:HTMLElement|Document|Event) {\n        const target = arg instanceof HTMLElement ? arg : document;\n        const elements = target.querySelectorAll(\"[data-pagy-json]\");\n        for (const element of elements) {\n            const json = element.getAttribute(\"data-pagy-json\");\n            if (json === null) {\n                continue;\n            }\n            const args = JSON.parse(json);\n            const fname = args.shift() as \"nav\"|\"combo_nav\"|\"items_selector\";\n            if (fname === \"nav\") {\n                Pagy.nav(element, ...args as [NavTags, NavSequels, null|NavLabelSequels, string]);\n            } else if (fname === \"combo_nav\") {\n                Pagy.combo_nav(element, ...args as [string, string, string]);\n            } else if (fname === \"items_selector\") {\n                Pagy.items_selector(element, ...args as [number, string, string]);\n            }\n        }\n    },\n\n    // Power the *_nav_js helpers\n    nav(pagyEl:Element, tags:NavTags, sequels:NavSequels, opt_label_sequels:null|NavLabelSequels, trimParam?:string) {\n        let label_sequels = {} as NavLabelSequels;\n        // Handle null label_sequels\n        if (opt_label_sequels === null) {\n            for (const width in sequels) {\n                label_sequels[width] = sequels[width].map((item) => item.toString());\n            }\n        } else {\n            label_sequels = opt_label_sequels;\n        }\n        // Set and sort the widths as number[]\n        const widths = Object.getOwnPropertyNames(sequels)\n                             .map((w) => parseInt(w))\n                             .sort((a, b) => b - a);\n        let lastWidth:number;\n        const fillIn = (string:string, item:string, label:string):string =>\n            string.replace(/__pagy_page__/g, item)\n                  .replace(/__pagy_label__/g, label);\n\n        pagyEl.pagyRender = () => {\n            // Find the width that fits in parent\n            const width = widths.find((w) => pagyEl.parentElement !== null && pagyEl.parentElement.clientWidth > w) || 0;\n            // Only if the width changed\n            if (width !== lastWidth) {\n                let html = tags.before;\n                const series = sequels[width.toString()];\n                const labels = label_sequels[width.toString()];\n                for (const i in series) {\n                    const item = series[i];\n                    const label = labels[i];\n                    if (typeof trimParam === \"string\" && item === 1) {\n                        const link = fillIn(tags.link, item.toString(), label);\n                        html += Pagy.trim(link, trimParam);\n                    } else if (typeof item === \"number\") {\n                        html += fillIn(tags.link, item.toString(), label);\n                    } else if (item === \"gap\") {\n                        html += tags.gap;\n                    } else { // active page\n                        html += fillIn(tags.active, item, label);\n                    }\n                }\n                html += tags.after;\n                pagyEl.innerHTML = \"\";\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                lastWidth = width;\n            }\n        };\n        pagyEl.pagyRender();\n        // If there is a window object then add a single \"resize\" event listener\n        if (typeof window !== \"undefined\") {\n            window.addEventListener(\"resize\", Pagy.throttleRenderNavs, true);\n        }\n    },\n\n    // throttleRenderNavs properties\n    throttleRenderNavsTID:   0,      // private\n    throttleRenderNavsDelay: 100,    // set a default delay\n\n    // Avoid to fire the pagyRender multiple times\n    throttleRenderNavs() {\n        clearTimeout(Pagy.throttleRenderNavsTID);\n        Pagy.throttleRenderNavsTID = window.setTimeout(Pagy.renderNavs, Pagy.throttleRenderNavsDelay);\n    },\n\n    // Render all *nav_js helpers (i.e. all the elements of class \"pagy-njs\")\n    renderNavs() {\n        const navs = document.getElementsByClassName(\"pagy-njs\");\n        Array.from(navs).forEach((nav) => nav.pagyRender());\n    },\n\n    // Power the *_combo_nav_js helpers\n    combo_nav(pagyEl:Element, page:string, link:string, trimParam?:string) {\n        const input = pagyEl.getElementsByTagName(\"input\")[0];\n        const goToPage = () => {\n            if (page !== input.value) {\n                let html = link.replace(/__pagy_page__/, input.value);\n                if (typeof trimParam === \"string\" && input.value === \"1\") {\n                    html = Pagy.trim(html, trimParam);\n                }\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                pagyEl.getElementsByTagName(\"a\")[0].click();\n            }\n        };\n        Pagy.addInputBehavior(input, goToPage);\n    },\n\n    // Power the pagy_items_selector_js helper\n    items_selector(pagyEl:Element, from:number, link:string, trimParam?:string) {\n        const input = pagyEl.getElementsByTagName(\"input\")[0];\n        const current = input.value;\n        const goToPage = () => {\n            const items = input.value;\n            if (items === \"0\" || items === \"\") {\n                return;\n            }\n            if (current !== items) {\n                const page = Math.max(Math.ceil(from / parseInt(items)), 1).toString();\n                let html = link.replace(/__pagy_page__/, page)\n                               .replace(/__pagy_items__/, items);\n                if (typeof trimParam === \"string\" && page === \"1\") {\n                    html = Pagy.trim(html, trimParam);\n                }\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                pagyEl.getElementsByTagName(\"a\")[0].click();\n            }\n        };\n        Pagy.addInputBehavior(input, goToPage);\n    },\n\n    // Add behavior to input fields\n    addInputBehavior(input:HTMLInputElement, goToPage:() => void) {\n        // select the content on click: easier for direct typing\n        input.addEventListener(\"click\", input.select);\n        // goToPage when the input loses focus\n        input.addEventListener(\"focusout\", goToPage);\n        // goToPage when pressing enter while the input has focus\n        input.addEventListener(\"keypress\", (e:KeyboardEvent) => {\n            if (e.key === \"Enter\") {\n                goToPage();\n            }\n        });\n    },\n\n    // Power the trim extra for js helpers\n    trim(link:string, param:string):string {\n        const re = new RegExp(`[?&]${param}=1\\\\b(?!&)|\\\\b${param}=1&`);\n        return link.replace(re, \"\");\n    }\n};\n"]}