{"version":3,"sources":["../../src/pagy.ts"],"names":[],"mappings":"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","file":"pagy.js","sourcesContent":["// This file is the source that generates pagy.js, polyfilled with the `@babel/preset-env` `\"useBuiltIns\": \"entry\"`.\n// You can generate a custom targeted javascript file for the browsers you need by changing that settings in package.json,\n// then compile it with `npm run compile -w src`.\n\n// Add pagyRender to Element\ninterface Element {\n    pagyRender():void;\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavTags {\n    readonly before:string;\n    readonly link:string;\n    readonly active:string;\n    readonly gap:string;\n    readonly after:string;\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavSequels {\n    readonly [width:string]:(string|number|\"gap\")[];\n}\n\n// Tags from the data-pagy-json of *nav_js helpers\ninterface NavLabelSequels {\n    [width:string]:(string|\"gap\")[];\n}\n\n// The Pagy object\nconst Pagy = {\n    version: \"5.6.9\",\n\n    // Scan for \"data-pagy-json\" elements, parse their JSON content and apply their functions\n    init(arg?:HTMLElement|Document|Event) {\n        const target = arg instanceof HTMLElement ? arg : document;\n        const elements = target.querySelectorAll(\"[data-pagy-json]\");\n        for (const element of elements) {\n            const json = element.getAttribute(\"data-pagy-json\");\n            if (json === null) { continue }\n            const args = JSON.parse(json);\n            const fname = args.shift() as \"nav\"|\"combo_nav\"|\"items_selector\";\n            if (fname === \"nav\") {\n                Pagy.nav(element, ...args as [NavTags, NavSequels, null|NavLabelSequels, string]);\n            } else if (fname === \"combo_nav\") {\n                Pagy.comboNav(element, ...args as [string, string, string]);\n            } else if (fname === \"items_selector\") {\n                Pagy.itemsSelector(element, ...args as [number, string, string]);\n            }\n        }\n    },\n\n    // Power the *_nav_js helpers\n    nav(pagyEl:Element, tags:NavTags, sequels:NavSequels, optLabelSequels:null|NavLabelSequels, trimParam?:string) {\n        let labelSequels = {} as NavLabelSequels;\n        // Handle null labelSequels\n        if (optLabelSequels === null) {\n            for (const width in sequels) {\n                labelSequels[width] = sequels[width].map((item) => item.toString());\n            }\n        } else {\n            labelSequels = optLabelSequels;\n        }\n        // Set and sort the widths as number[]\n        const widths = Object.getOwnPropertyNames(sequels)\n                             .map((w) => parseInt(w))\n                             .sort((a, b) => b - a);\n        let lastWidth:number;\n        const fillIn = (string:string, item:string, label:string):string =>\n            string.replace(/__pagy_page__/g, item)\n                  .replace(/__pagy_label__/g, label);\n\n        pagyEl.pagyRender = function () {\n            // Find the width that fits in parent\n            const width = widths.find((w) =>\n                pagyEl.parentElement !== null && pagyEl.parentElement.clientWidth > w\n            ) || 0;\n            // Only if the width changed\n            if (width !== lastWidth) {\n                let html = tags.before;\n                const series = sequels[width.toString()];\n                const labels = labelSequels[width.toString()];\n                for (const i in series) {\n                    const item = series[i];\n                    const label = labels[i];\n                    if (typeof trimParam === \"string\" && item === 1) {\n                        const link = fillIn(tags.link, item.toString(), label);\n                        html += Pagy.trim(link, trimParam);\n                    } else if (typeof item === \"number\") {\n                        html += fillIn(tags.link, item.toString(), label);\n                    } else if (item === \"gap\") {\n                        html += tags.gap;\n                    } else { // active page\n                        html += fillIn(tags.active, item, label);\n                    }\n                }\n                html += tags.after;\n                pagyEl.innerHTML = \"\";\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                lastWidth = width;\n            }\n        };\n        pagyEl.pagyRender();\n        // If there is a window object then add a single throttled \"resize\" event listener\n        if (typeof window !== \"undefined\") {\n            let tid = 0;\n            window.addEventListener(\"resize\", () => {\n                clearTimeout(tid);\n                tid = window.setTimeout(Pagy.renderNavs, 100);\n            }, true);\n        }\n    },\n\n    // Render all *nav_js helpers (i.e. all the elements of class \"pagy-njs\")\n    renderNavs() {\n        const navs = document.getElementsByClassName(\"pagy-njs\");\n        Array.from(navs).forEach((nav) => nav.pagyRender());\n    },\n\n    // Power the *_combo_nav_js helpers\n    comboNav(pagyEl:Element, page:string, link:string, trimParam?:string) {\n        const input = pagyEl.getElementsByTagName(\"input\")[0];\n        Pagy.addInputBehavior(input, () => {\n            if (page !== input.value) {\n                let html = link.replace(/__pagy_page__/, input.value);\n                if (typeof trimParam === \"string\" && input.value === \"1\") {\n                    html = Pagy.trim(html, trimParam);\n                }\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                pagyEl.getElementsByTagName(\"a\")[0].click();\n            }\n        });\n    },\n\n    // Power the pagy_items_selector_js helper\n    itemsSelector(pagyEl:Element, from:number, link:string, trimParam?:string) {\n        const input = pagyEl.getElementsByTagName(\"input\")[0];\n        const current = input.value;\n        Pagy.addInputBehavior(input, () => {\n            const items = input.value;\n            if (items === \"0\" || items === \"\") {\n                return;\n            }\n            if (current !== items) {\n                const page = Math.max(Math.ceil(from / parseInt(items)), 1).toString();\n                let html = link.replace(/__pagy_page__/, page)\n                               .replace(/__pagy_items__/, items);\n                if (typeof trimParam === \"string\" && page === \"1\") {\n                    html = Pagy.trim(html, trimParam);\n                }\n                pagyEl.insertAdjacentHTML(\"afterbegin\", html);\n                pagyEl.getElementsByTagName(\"a\")[0].click();\n            }\n        });\n    },\n\n    // Add behavior to input fields\n    addInputBehavior(input:HTMLInputElement, goToPage:() => void) {\n        // select the content on click: easier for direct typing\n        input.addEventListener(\"click\", input.select);\n        // goToPage when the input loses focus\n        input.addEventListener(\"focusout\", goToPage);\n        // goToPage when pressing enter while the input has focus\n        input.addEventListener(\"keypress\", (e:KeyboardEvent) => {\n            if (e.key === \"Enter\") { goToPage() }\n        });\n    },\n\n    trim: (link:string, param:string):string =>\n              link.replace(new RegExp(`[?&]${param}=1\\\\b(?!&)|\\\\b${param}=1&`), \"\")\n};\n"]}