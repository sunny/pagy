{"version":3,"sources":["../../src/pagy.ts"],"names":[],"mappings":"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","file":"pagy.js","sourcesContent":["// This file is the source that generates pagy.js, polyfilled with the `@babel/preset-env` `\"useBuiltIns\": \"entry\"`.\n// You can generate a custom targeted javascript file for the browsers you need by changing that settings in package.json,\n// then compile it with `npm run compile -w src`.\n\n// Args types and interfaces from data-pagy-json\ntype PagyJSON          = readonly [\"nav\", ...NavArgs] | [\"combo_nav\", ...ComboNavArgs] | [\"items_selector\", ...ItemsSelectorArgs]\ntype NavArgs           = readonly [NavTags, NavSequels, null|NavLabelSequels, string?]\ntype ComboNavArgs      = readonly [string, string?]\ntype ItemsSelectorArgs = readonly [number, string, string?]\n\ninterface NavTags {\n    readonly before: string\n    readonly link:   string\n    readonly active: string\n    readonly gap:    string\n    readonly after:  string\n}\ninterface NavSequels      { readonly [width:string]: (string|number|\"gap\")[] }\ninterface NavLabelSequels { readonly [width:string]: string[] }\ninterface Element         { pagyRender(): void }\n\n// The Pagy object\nconst Pagy = {\n    version: \"5.7.0\",\n\n    // Scan for \"data-pagy-json\" elements, parse their JSON content and call their init functions\n    init(arg?:Element|never) {\n        const target   = arg instanceof Element ? arg : document;\n        const elements = target.querySelectorAll(\"[data-pagy-json]\");\n        const warn     = (el:Element, err:unknown) => console.warn(\"Pagy.init() skipped element: %o\\n%s\", el, err);\n        for (const element of elements) {\n            const json = element.getAttribute(\"data-pagy-json\") as string;\n            try {\n                const [keyword, ...args] = JSON.parse(json) as PagyJSON;\n                if (keyword === \"nav\") {\n                    Pagy.initNav(element, args as NavArgs);\n                } else if (keyword === \"combo_nav\") {\n                    Pagy.initComboNav(element, args as ComboNavArgs);\n                } else if (keyword === \"items_selector\") {\n                    Pagy.initItemsSelector(element, args as ItemsSelectorArgs);\n                } else {\n                    warn(element, `Illegal PagyJSON keyword: expected \"nav\"|\"combo_nav\"|\"items_selector\" got \"${keyword}\"`);\n                }\n            } catch (err) { warn(element, err) }\n        }\n    },\n\n    // Init the *_nav_js helpers\n    initNav(el:Element, [tags, sequels, labelSequels, trimParam]:NavArgs) {\n        const container = el.parentElement || el;\n        const widths    = Object.getOwnPropertyNames(sequels).map(w => parseInt(w)).sort((a, b) => b - a);\n        let lastWidth   = -1;\n        const fillIn    = (string:string, item:string, label:string):string =>\n                              string.replace(/__pagy_page__/g, item).replace(/__pagy_label__/g, label);\n        (el.pagyRender = function () {\n            const width = widths.find(w => w < container.clientWidth) || 0;\n            if (width === lastWidth) { return } // no change: abort\n            let html     = tags.before;\n            const series = sequels[width.toString()];\n            const labels = labelSequels === null ? series.map(l => l.toString()) : labelSequels[width.toString()];\n            for (const i in series) {\n                const item  = series[i];\n                const label = labels[i];\n                if (typeof trimParam === \"string\" && item === 1) {\n                    const link = fillIn(tags.link, item.toString(), label);\n                    html      += Pagy.trim(link, trimParam);\n                } else if (typeof item === \"number\") {\n                    html += fillIn(tags.link, item.toString(), label);\n                } else if (item === \"gap\") {\n                    html += tags.gap;\n                } else { // active page\n                    html += fillIn(tags.active, item, label);\n                }\n            }\n            html        += tags.after;\n            el.innerHTML = \"\";\n            el.insertAdjacentHTML(\"afterbegin\", html);\n            lastWidth = width;\n        })();\n        if (el.classList.contains(\"pagy-rjs\")) { Pagy.rjsObserver.observe(container) }\n    },\n\n    // The observer instance for responsive navs\n    rjsObserver: new ResizeObserver(entries => {\n        entries.filter(e => e.contentBoxSize)\n               .forEach(e => e.target.querySelectorAll(\".pagy-rjs\")\n                                     .forEach(rjs => rjs.pagyRender()));\n    }),\n\n    // Init the *_combo_nav_js helpers\n    initComboNav(el:Element, [link, trimParam]:ComboNavArgs) {\n        const input   = el.querySelector(\"input\") as HTMLInputElement;\n        const initial = input.value;\n        Pagy.initInput(input, () => {\n            if (!Pagy.validValueFor(input, initial)) { return } // abort action\n            const html = link.replace(/__pagy_page__/, input.value);\n            Pagy.finalizeAction(el, html, input.value, trimParam);\n        });\n    },\n\n    // Init the pagy_items_selector_js helper\n    initItemsSelector(el:Element, [from, link, trimParam]:ItemsSelectorArgs) {\n        const input   = el.querySelector(\"input\") as HTMLInputElement;\n        const initial = input.value;\n        Pagy.initInput(input, () => {\n            if (!Pagy.validValueFor(input, initial)) { return } // abort action\n            const page = Math.max(Math.ceil(from / parseInt(input.value)), 1).toString();\n            const html = link.replace(/__pagy_page__/, page).replace(/__pagy_items__/, input.value);\n            Pagy.finalizeAction(el, html, page, trimParam);\n        });\n    },\n\n    // Init input field\n    initInput(input:HTMLInputElement, action:() => void) {\n        [\"change\", \"focus\"].forEach(e => input.addEventListener(e, input.select));        // auto-select\n        input.addEventListener(\"focusout\", action);                                       // trigger action\n        input.addEventListener(\"keypress\", e => { if (e.key === \"Enter\") { action() } }); // trigger action\n    },\n\n    // Check for valid value or reset it\n    validValueFor(input:HTMLInputElement, initial:string):boolean {\n        if (input.value === initial) { return false }  // not changed\n        const [min, val, max] = [input.min, input.value, input.max].map(n => parseInt(n) || 0);\n        if (val >= min && val <= max) { return true }  // in range\n        input.value = initial;  // reset invalid/out-of-range\n        input.select();\n        return false;\n    },\n\n    // Finalize the input action\n    finalizeAction(el:Element, html:string, page:string, trimParam?:string) {\n        if (typeof trimParam === \"string\" && page === \"1\") { html = Pagy.trim(html, trimParam) }\n        el.insertAdjacentHTML(\"afterbegin\", html);\n        (el.querySelector(\"a\") as HTMLAnchorElement).click();\n    },\n\n    // Trim the ${page-param}=1 params in links\n    trim: (link:string, param:string) => link.replace(new RegExp(`[?&]${param}=1\\\\b(?!&)|\\\\b${param}=1&`), \"\")\n};\n"]}